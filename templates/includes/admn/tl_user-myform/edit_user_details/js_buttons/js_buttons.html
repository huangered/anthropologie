<SCRIPT type="text/javascript">
<!-- Hide

<!--
//check if textbox form element is empty and put focus on that element if empty
//form: form name
//elm: element to check
//errMsg: error message - only appears if an error parameter is passed
function chkField(form, elm, errMsg) {	
	var curElm = document.forms[form].elements[elm];	
	if (curElm.value != '' && curElm.value.length != 0) {
		return true; 
	} else {
		if (arguments[2] != undefined) {
			alert(errMsg);
			curElm.focus();
		}
		return false;
	}
}

//check if textbox form element is a number, all white spaces are removed
//form: form name
//elm: element to check
//errMsg: error message - only appears if an error parameter is passed
function isNum(form, elm, errMsg) {
	var numOnly =/^\d+$/;
	var curElm = document.forms[form].elements[elm];
	var strpdField = curElm.value.replace(/\s+/g,'');
	if (numOnly.test(strpdField)) {  
		return true;
	} else {
		if (arguments[2] != undefined) {
			alert(errMsg);
			curElm.focus();
		}
		return false;
	}
}

//check if select form element is empty and put focus on that element if empty
//form: form name
//elm: element to check
//errMsg: error message
function chkDropdown(form, elm, errMsg) {
	var objDropdown = document.forms[form].elements[elm];
	var objSelectValue = objDropdown.options[objDropdown.selectedIndex].value; 
	if (objSelectValue != "") {
		return true;
	} else {
		if (arguments[2] != undefined) {
			alert(errMsg);
			objDropdown.focus();
		}
		return false;
	}
}

// isRequiredField - this param is set to 'true' when country field is 'US', for validating State and Zipcode
var isRequiredField = false;

function validateFields() {
	var curFrm = "form"; //set form name
	var isValid=0;
	if (!chkField(curFrm, 'title', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.title>')) { isValid=1; return false; }
	if (!chkField(curFrm, 'fname', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.first_name>')) { isValid=1; return false; }
	if (!chkField(curFrm, 'lname', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.last_name>')) { isValid=1; return false; }
	<venda_block label=88,mode=value,<venda_setting type=ebiz,name=nohousenum>!=1>
	if (!chkField(curFrm, 'num', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.num>')) { isValid=1; return false; }
	</venda_block label=88>
	if (!chkField(curFrm, 'addr1', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.addr1>')) { isValid=1; return false; }
	if (!chkField(curFrm, 'city', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.city>')) { isValid=1; return false; }

    if(isRequiredField){
    	if (!chkField(curFrm, 'statelist', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.state>')) { isValid=1; return false; }
    	if (!chkField(curFrm, 'zipc', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.zipc.us>')) { isValid=1; return false; }
    }
   	if (!chkField(curFrm, 'zipc', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.zipc>')) { isValid=1; return false; }
	if (!chkDropdown(curFrm, 'cntry', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.cntry>')) { isValid=1; return false; }
	<venda_block label=190,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>
	if (chkField(curFrm, 'area')) { 
		if (!isNum(curFrm, 'area', '<venda_text id=site.contact_address.js_validation.area_code>')) { isValid=1; return false; }
	}
	</venda_block label=190>
	if (chkField(curFrm, 'phone')) {
		if (!isNum(curFrm, 'phone', '<venda_text id=site.contact_address.js_validation.phone_no>')) { isValid=1; return false; }
	}
	<venda_block label=1901,mode=value,<venda_setting type=ebiz,name=showfax>=1>
	<venda_block label=1911,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>
	if (chkField(curFrm, 'farea')) { 
		if (!isNum(curFrm, 'farea', '<venda_text id=site.singlesteppc_lookup.contact_address.js_validation.farea_digits>')) { isValid=1; return false; }
	}
	</venda_block label=1911>
	if (chkField(curFrm, 'fax')) {
		if (!isNum(curFrm, 'fax', '<venda_text id=site.singlesteppc_lookup.contact_address.js_validation.fax_digits>')) { isValid=1; return false; }
	}
	</venda_block label=1901>
	// password validation is only performed when password fields are present
	<venda_block label=191,mode=value,<venda_setting type=ebiz,name=hidearea>!=1>
	if (!chkField(curFrm, 'area', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.area>')) { isValid=1; return false; }
	</venda_block label=191>
	if (!chkField(curFrm, 'phone', '<venda_text id=site.singlesteppc_lookup.contact_address.delivery_address.js_validation.phone>')) { isValid=1; return false; }
	if(isValid===0){
		return true;
	} else {
		return false;
	}
}

function CheckFields(form1) {
	if (validateFields()) {
		form1.submit();
	}
}
//End Javascript-->
</SCRIPT>

<div id="buttons">
<a href="<venda_dispview page=myaccount>"><img src="<venda_entmediaadd>/ebiz/<venda_bsref>/resources/images/<venda_sessionlanguage>/bt_previous_myacc.gif" alt="<venda_text id=site.button.previous_myacc>" border="0" class="left"></a>
<input type="image" onClick="CheckFields(document.form); return false;" src="<venda_entmediaadd>/ebiz/<venda_bsref>/resources/images/<venda_sessionlanguage>/bt_submit2.jpg" alt="<venda_text id=site.button.submit>" class="left">
</div>

<script type="text/javascript">
function swapLabel(){
        var stateLabel = document.getElementById("stateLabel");
        var zipcLabel = document.getElementById("zipcLabel");
        var cntryLabel = document.getElementById("countryLabel");
        var country = document.getElementById("cntrylist");

	if(country == undefined) { return; } //if country is undefined do nothing

                if(country.value == "United States"){
                        stateLabel.innerHTML = '<venda_text id=site.contact_address.label.us_state>:<span class="re-waiHide"> <venda_text id=site.accessible.label.required></span> <span class="required">*</span>';
			zipcLabel.innerHTML = '<venda_text id=site.contact_address.zipc.us_zipcode> <span class="re-waiHide"> <venda_text id=site.accessible.label.required></span> <span class="required">*</span>';
			isRequiredField = true;
                }
                else if(country.value == "United Kingdom"){
                        stateLabel.innerHTML = '<venda_text id=site.contact_address.label.uk_county>';
                        zipcLabel.innerHTML = '<venda_text id=site.contact_address.zipc.non_us_postcode>';
                        isRequiredField = false;
                }
                else {
                        stateLabel.innerHTML = '<venda_text id=site.contact_address.label.non_us_uk_region>';
                        zipcLabel.innerHTML = '<venda_text id=site.contact_address.zipc.non_us_postcode>';
                        isRequiredField = false;
                }
}
				jQuery(document).ready(function(){
					swapLabel();
				});
                addEvent(document.form.cntry, 'change', swapLabel, true);
</script>

